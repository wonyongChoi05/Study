시각화에 필요한 정보만을 모은 데이터 마트는 필수적이다.

# 시각화에 적합한 데이터 마트 만들기(OLAP)
---
RDB는 표형식으로 모델링된 데이터를 SQL로 집계한다. OLAP에서는 다차원 모데의 데이터 구조를 MDX(multidimensional expressions) 쿼리 언어로 집계한다.
데이터 분석을 위해 만들어진 다차원 데이터를 OLAP 큐브라고 부른다. 이를 크로스 집계하는 구조가 OLAP이다.

데이터 마트, 즉 분석을 위한 데이터베이스의 핵심은 OLAP이다. OLAP은 데이터 집계를 효율화하는 접근 방법 중의 하나다.
이전에는 성능이 좋지 않았기 때문에 분석을 위한 집계를 미리 계산하여 데이터베이스 안에 캐시해두었지만, 이제는 그럴 필요가 없어졌다.

본래 BI 도구는 OLAP 구조를 사용하여 데이터를 집계하기 위한 소프트웨어이며 데이터 마트도 OLAP 큐브로 작성되었다.
그러나 MPP 데이터베이스와 인메모리 데이터베이스 등의 보급으로, BI 도구와 MPP 데이터베이스를 조합하여 크로스 집계하여, 분석에 용이하게 분석용 데이터베이스를 비정규화 테이블로 구성하여 사용한다.

# 테이블 비정규화 하기
---
테이블은 트랜잭션과 마스터로 구분되는데 트랜잭션은 시간의 흐름에 따른 데이터의 기록이고, 마스터는 개별적인 정보이다.
예를 들어 유저들의 정보가 마스터 테이블이라면, 그 유저드의 서비스 이용 내역 정보는 트랜잭션 테이블이 되는 것이다.

데이터 웨어하우스에서는 트랜잭션과 비슷한 개념이 팩트 테이블이며 사실을 기록하고, 디멘션 테이블이 마스터 테이블의 개념이다.
이에 더 심화되어서 정교하게 작업한다면, 팩트 테이블에는 각 디멘션 테이블들에 대한 집계값도 들어가야 한다.

일반적으로 데이터 웨어하우스와 데이터 마트 모두 스타 스키마 형태로 구축하고, 데이터 마트를 비정규화 하자.
그 이유는 데이터의 구조를 이해하기 쉽고, 데이터 분석을 쉽게 할 수 있기 때문이다.

또한 성능상의 이유로도 스키마 형태를 잘 짜야 한다. 
데이터 양이 증가함에 따라 팩트 테이블은 커지고 어느 순간 메모리 용량을 초과하여 디스크 I/O가 발생하여 쿼리 지연을 불러일으킬 수 있다.
따라서 팩트 테이블은 될 수 있는 한 작게 구성하는 것이 고속화에 중요하다.

디멘션 테이블 작성시에는 정보가 중복되어도 좋으니, 최대한 분해된 테이블들을 합치는 작업이 필요하다. 
실제로 팩트 테이블이 데이터 분석 성능으 좌우하기 때문에 결국 ID 키 값만 남는다.

그러나 최근 MPP 데이터베이스로 열 지향 스토리지를 갖는 시스템이 보급됨으로써 컬럼의 수가 아뮈 늘어도 성능에 영향을 주지 않는다.
따라서 애초에 팩트 테이블에 모든 컬럼을 포함하여 비정규화를 최대한 진행하여 쿼리 실행시 조인을 최소화 하는 것이 간단하다.

즉, 데이터 마트에 스타 스키마가 사용되는 것은 과거의 이야기이다. 
적어도 성능상의 문제가 열 지향 스토리지로 해결되어서 거대한 하나의 팩트 테이블만 있어도 충분하게 되었다.

그러나 데이터 웨어하우스는 스타 스키마가 우수하다. 
데이터를 축적하는 단계에서는 팩트 테이블과 디멘션 테이블로 분리하고 분석 단계에서 최종적으로 결합하여 비정규화 테이블을 만드는 것을 추천한다.