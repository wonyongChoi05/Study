# 데이터베이스의 지연 줄이기
---
탐색, 즉 시각화하여 데이터 분석에 활용하기 위해서는 데이터 저장소에서 데이터를 가지고 오는 과정이 필요하다.
이를 탐색이라 하는데, 이를 위해 데이터를 처리하는 대기 시간이나 지연이 적도록 해야한다.

가장 간단한 방법은 모든 데이터를 메모리에 올리는 것이다. 하지만 이 또한 메모리 용량을 초과하는 데이터의 경우에는 불가능하다.

데이터베이스 자체의 메모리를 늘리면 되지만 보통은 데이터를 분산/압축하는 방식을 사용한다.
압축하고 분산된 데이터를 읽어들이려면 멀티코어를 활용하여 디스크 I/O를 병렬처리해야 한다.

이를 위해서는 MPP(massive parallel processing : 대규모 병렬처리) 아키텍쳐를 기반으로 한 데이터베이스를 사용한다.
이러한 데이터베이스는 또한 기본적으로 열지향 데이터베이스로서 분석을 위한 대용량 읽기 처리를 지원한다.

# 열 지향 데이터베이스 접근(컬럼을 압축화여 디스크 I/O 줄이기)
---
일반적으로 업무 시스템에서 사용되는 데이터베이스는 레코드 단위의 읽기 쓰기에 최적화 되어 있으며, 이를 행 지향 데이터베이스라고 부른다.
하지만 빅데이터를 다루는 경우에는 쿼리에 필요한 최소한의 데이터를 가져옴으로써 지연을 줄여야 하고 이 때 컬럼 단위로의 데이터 압축 방법을 사용한다.

> 데이터 처리의 성능은 두 종류의 숫자로 표시된다.
> 
> - 일정 시간에 처리할 수 있는 데이터의 양(throughput: 처리량) : 대규모 데이터 처리에서 중요
> - 데이터 처리가 끝날 때까지의 대기시간(latency: 지연시간) : 데이터 분석에서 중시
> 
> 이 두가지는 무조건 양립하진 않는다.
> 일반적으로 데이터 웨어하우스와 데이터 레이크는 대량의 데이터를 처리하기 위해 처리량에 집중했다.
> 반면, 데이터 마트는 지연시간의 단축에 집중했다.

- 헹 지향 데이터베이스 : 테이블의 각 행을 하나의 덩어리로 디스크에 저장한다. 일반적으로 업무용 데이터베이스의 경우 쓰기/수정 작업 등의 트랜잭션 처리가 많으므로, 이에 특화되어있다. 읽기 작업을 위해 인덱스 작업은 필수이다.
- 열 지향 데이터베이스 : 이부 컬럼만이 집계 대상이 된다. 데이터를 미리 컬럼 단위로 정리해 둠으로써 필요한 컬럼만을 로드하여 디스크 I/O를 줄인다.

# MPP 데이터베이스의 접근 방식(병렬화에 의해 멀티코어 활용)
---
열 지향 데이터베이스에서는 한 번의 쿼리로 대량의 데이터를 읽어들이고 압축된 데이터를 전개하므로 CPU 리소스가 많이 필요하여 멀티코어를 활용하여 고속화 하는 것이 좋다.

MPP에서는 하나의 쿼리를 작은 태스크로 분해하고 이를 가능한 병렬로 실행한다. 이후 CPU 코어 수에 비례하여 고속화한다.
단, 디스크로부터 병목이 발생하지 않도록 데이터가 고르게 분산되어 있어야 한다.

하드웨어적인 작업의 효율성을 위해서 하드웨어와 소프트웨어가 결합한 MPP 데이터베이스를 사용하기도 한다.
이에 따라 실제로 모든 데이터 저장소로 MPP 아키텍처를 따른 데이터베이스를 쓸 것 같지만 때에 따라서는 Hadoop과 함께 대화형 쿼리엔진을 사용하기도 한다.

이 때 데이터를 저장하는 것은 분산 스토리지의 역할이다. 
그러나 결국 열 지향으로 압축해야 하는 작업을 해야하므로 데이터를 저장할 때 열 지향 스토리지로 만들기 위해 별도 라이브러리를 사용해야 한다.

Hadoop과의 궁합을 위해서 이를 감안하고 택하기도 한다. 반대로 시스템의 안정성과 서포트 체제등을 고려해서는 MPP 데이터베이스를 쓰기도 한다.